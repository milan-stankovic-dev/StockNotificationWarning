@using Microsoft.Extensions.Options
@using StockNotificationWarning.Config
@using System.Text.Json
@inject IOptionsMonitor<ShopifyConfig> ShopifyConfig

@{
    var shop = ShopifySessionStore.ShopName ?? "N/A";
    var apiKey = ShopifyConfig.CurrentValue.ApiKey;
    var host = ShopifySessionStore.Host;
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>@ViewData["Title"] - Admin</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css" />

    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            margin: 0;
            display: flex;
            height: 100vh;
            background: #f9fafb;
        }

        .main {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
        }
    </style>
</head>
<body data-api-key="@apiKey" data-host="@host">
    <div class="main">
        @RenderBody()
    </div>

    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

    <script type="module">
        import { initApp } from '/js/app-bridge-bundle.js';

        const body = document.body;
        const apiKey = body.dataset.apiKey;
        const host = body.dataset.host;

        initApp(apiKey, host);
    </script>

    @RenderSection("Scripts", required: false)
</body>
</html>
